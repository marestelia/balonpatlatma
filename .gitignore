import pygame
import random

# Renkler
SIYAH = (0, 0, 0)
BEYAZ = (255, 255, 255)
SARI = (255, 255, 0)
TURUNCU = (255, 165, 0)
KIRMIZI = (255, 0, 0)

# Ekran boyutları
ekran_genislik = 800
ekran_yukseklik = 600

# Oyun başlangıcı ve bitişi
OYUN_BASLADI = False
OYUN_BITTI = False

# Pygame başlatma
pygame.init()
ekran = pygame.display.set_mode((ekran_genislik, ekran_yukseklik))
pygame.display.set_caption("Balon Patlatma Oyunu")

# Font ayarları
font = pygame.font.Font(None, 36)

# Skor ve canlar
skor = 0
canlar = 3

# Balonlar için sprite sınıfı
class Balon(pygame.sprite.Sprite):
    def __init__(self, renk, hiz):
        super().__init__()
        self.image = pygame.Surface([50, 50])
        self.image.fill(renk)
        self.rect = self.image.get_rect()
        self.hiz = hiz
        self.renk = renk

    def update(self):
        self.rect.y -= self.hiz
        if self.rect.y < -self.rect.height:
            global canlar
            canlar -= 1
            self.kill()

# Balonları tutacak grup
balonlar = pygame.sprite.Group()

# Oyunu başlatma
def oyunu_baslat():
    global OYUN_BASLADI, OYUN_BITTI, skor, canlar
    OYUN_BASLADI = True
    OYUN_BITTI = False
    skor = 0
    canlar = 3
    balonlar.empty()

# Oyuncu girişlerini işleme
def oyuncu_inputu_isle():
    global OYUN_BASLADI, OYUN_BITTI, canlar, skor
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            pygame.quit()
            quit()
        elif event.type == pygame.MOUSEBUTTONDOWN:
            fare_x, fare_y = pygame.mouse.get_pos()
            if not OYUN_BASLADI:
                if oyun_baslama_rect.collidepoint(fare_x, fare_y):
                    oyunu_baslat()
            elif OYUN_BITTI:
                if oyun_tekrar_rect.collidepoint(fare_x, fare_y):
                    oyunu_baslat()
            else:
                for balon in balonlar:
                    if balon.rect.collidepoint(fare_x, fare_y):
                        if balon.renk == SARI:
                            balon.renk = TURUNCU
                        elif balon.renk == TURUNCU:
                            balon.renk = KIRMIZI
                        elif balon.renk == KIRMIZI:
                            skor += 1
                            balon.kill()

# FPS ayarlama
zamanlayici = pygame.time.Clock()

# Oyun döngüsü
while True:
    # Arka planı temizleme
    ekran.fill(SIYAH)

    if OYUN_BASLADI and not OYUN_BITTI:
        # Balonları oluşturma
        if len(balonlar) < 5:
            renkler = [KIRMIZI, KIRMIZI, KIRMIZI, TURUNCU, TURUNCU, SARI, SARI]
            renk = random.choice(renkler)
            hiz = random.randint(1, 3)
            balon = Balon(renk, hiz)
            balon.rect.x = random.randint(0, ekran_genislik - balon.rect.width)
            balon.rect.y = ekran_yukseklik
            balonlar.add(balon)

        # Balonları güncelleme
        balonlar.update()

        # Canları azaltma
        if canlar <= 0:
            OYUN_BITTI = True

    # Balonları ekrana çizme
    for balon in balonlar:
        pygame.draw.ellipse(ekran, balon.renk, balon.rect)

    # Skor ve canları ekrana yazdırma
    skor_yazi = font.render("Skor: " + str(skor), True, BEYAZ)
    can_yazi = font.render("Can: " + str(canlar), True, BEYAZ)
    ekran.blit(skor_yazi, (10, 10))
    ekran.blit(can_yazi, (10, 50))

    if not OYUN_BASLADI:
        # Oyun başlama metnini ekrana yazdırma
        oyun_baslama_yazi = font.render("Oyuna Başla", True, BEYAZ)
        oyun_baslama_rect = oyun_baslama_yazi.get_rect(center=(ekran_genislik // 2, ekran_yukseklik // 2))
        ekran.blit(oyun_baslama_yazi, oyun_baslama_rect)
    elif OYUN_BITTI:
        # Oyun tekrar oynama metnini ekrana yazdırma
        oyun_tekrar_yazi = font.render("Tekrar Oyna", True, BEYAZ)
        oyun_tekrar_rect = oyun_tekrar_yazi.get_rect(center=(ekran_genislik // 2, ekran_yukseklik // 2))
        ekran.blit(oyun_tekrar_yazi, oyun_tekrar_rect)

    # Kullanıcı girişlerini işleme
    oyuncu_inputu_isle()

    # Ekranı güncelleme
    pygame.display.update()
    zamanlayici.tick(60)


